---
title: "Proyecto Final - Clustering Kmeans"
author: "Anna Casillas"
date: "Agosto 1,2020"
output: rmarkdown::github_document
---

# Clustering Kmeans#

Equipo:

* Anna Karen Casillas
* Josue Emmnanuel Gomez
* Luis Francisco Gonzalez
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,fig.path = "figure/imgs/README_figs/README-")
```

## Variables y Dependencias Iniciales

Aqui se especifican las variables generales necesarias para todo el proyecto

```{r}
#Modificar variable para especificar directorio del Proyecto Final
user.path <- "/Users/akcasill/Documents/analisisDatos/proyecto/mcc-analisisdatos-final"

local.path <- paste(user.path ,"/data",sep = "")
local.path.imgs <- paste(user.path ,"/imgs",sep = "")
```
Aqui se especifican todas las dependencias que se utilizaran en el proyecto

```{r}
#Dependencies
#install.packages("png")
library(png)
library(corrplot)
source("http://www.sthda.com/upload/rquery_cormat.r")
col<- colorRampPalette(c("blue", "white", "red"))(20)
```

Cargamos los datos integrados

```{r}
setwd(local.path)
load("datos.integrados.R")
#datos.integrados.df
head(datos.integrados.df,3)
```

## Particion de Datos ##

Separamos 100 alumnos que no entraran en Kmeans.

```{r}
set.seed(1234)

alumnos.gen <- sample(x=c(0,1),size=nrow(datos.integrados.df), replace=TRUE,prob = c(0.9,0.1))

#alumnos.gen
head(alumnos.gen,5)

alumnos.nuevos <- datos.integrados.df[alumnos.gen==1,]
alumnos.actuales <- datos.integrados.df[alumnos.gen==0,]

#alumnos.nuevos
head(alumnos.nuevos,5)
#alumnos.actuales
head(alumnos.actuales,5)
```

```{r}
summary(alumnos.nuevos)
```

```{r}
summary(alumnos.actuales)
```

Separamos 70-30 training set.

```{r}
set.seed(1234)

alumnos.sep <- sample(x=c(0,1),size=nrow(alumnos.actuales),replace=TRUE,prob = c(0.7,0.3))
#alumnos.sep
head(alumnos.sep,3)

alumnos.training <- alumnos.actuales[alumnos.sep==0,]
alumnos.test <- alumnos.actuales[alumnos.sep==1,]

str(alumnos.training)
summary(alumnos.training)
```

```{r}
alumnos.training$genero <- as.numeric(alumnos.training$genero)
alumnos.training$edad.ingreso <- as.numeric(alumnos.training$edad.ingreso)
alumnos.training$evalucion.socioeconomica <- as.numeric(alumnos.training$evalucion.socioeconomica)
alumnos.training$beca <- as.numeric(alumnos.training$beca)
alumnos.training$cambio.carrera <- as.numeric(alumnos.training$cambio.carrera)
str(alumnos.training)
```

```{r}
alumnos.test$genero <- as.numeric(alumnos.test$genero)
alumnos.test$edad.ingreso <- as.numeric(alumnos.test$edad.ingreso)
alumnos.test$evalucion.socioeconomica <- as.numeric(alumnos.test$evalucion.socioeconomica)
alumnos.test$beca <- as.numeric(alumnos.test$beca)
alumnos.test$cambio.carrera <- as.numeric(alumnos.test$cambio.carrera)
str(alumnos.test)
```

```{r}
alumnos.actuales$genero <- as.numeric(alumnos.actuales$genero)
alumnos.actuales$edad.ingreso <- as.numeric(alumnos.actuales$edad.ingreso)
alumnos.actuales$evalucion.socioeconomica <- as.numeric(alumnos.actuales$evalucion.socioeconomica)
alumnos.actuales$beca <- as.numeric(alumnos.actuales$beca)
alumnos.actuales$cambio.carrera <- as.numeric(alumnos.actuales$cambio.carrera)
str(alumnos.actuales)
```

## Analisis de Correlacion ##

```{r}
jpeg('imgs/correlacion-alumnos-ad.jpg', width=1920, height=1080)
rquery.cormat(alumnos.training, type="full", col=col)
dev.off()
cormat<-rquery.cormat(alumnos.training, type="full", col=col)
```

correlacion con pearson

```{r}
cor.matrix <- cor(alumnos.training, method = "pearson", use = "complete.obs")
corrplot(cor.matrix)
```


## Analisis de hombro,codo,brazo ##

Este analisis es para obtener cuantos centroides debemos usar

```{r}
set.seed(12345)
wss.alumnos <-vector()
wss.alumnos
centroides.alumnos <- 25
for ( i in 1:centroides.alumnos ) 
  wss.alumnos[i] <- kmeans(alumnos.training,centers = i,nstart=20)$tot.withinss

#plot
plot(1:centroides.alumnos  , wss.alumnos , type="b", xlab = "Number of Clusters", ylab = "Within groups sum of squares")
```

```{r}
imgPath.codo <- paste(local.path.imgs,"/Kmeans-codo-alumnos.png",sep = "")


img.codo.alumnos <- readPNG(imgPath.codo)
plot.new()
rasterImage(img.codo.alumnos,0,0,1,1)
```

```{r}
set.seed(12345)
wss.alumnos <-vector()
wss.alumnos
centroides.alumnos <- 10
for ( i in 1:centroides.alumnos ) 
  wss.alumnos[i] <- kmeans(alumnos.training,centers = i,nstart=20)$tot.withinss

#plot
plot(1:centroides.alumnos  , wss.alumnos , type="b", xlab = "Number of Clusters", ylab = "Within groups sum of squares")
```

```{r}
imgPath.codo.seleccionado <- paste(local.path.imgs,"/Kmeans-codo-alumnos-seleccionado.png",sep = "")


img.codo.sel.alumnos <- readPNG(imgPath.codo.seleccionado)
plot.new()
rasterImage(img.codo.sel.alumnos,0,0,1,1)

```

## Kmeans - 3 Clusters ##

```{r}
# Set seed
set.seed(12345)
# Create the k-means model: km.out
km.out <- kmeans(alumnos.training, centers = 3, nstart = 20)

# Inspect the result
summary(km.out)
```

```{r}
# Print the cluster membership component of the model
km.out$cluster
```


```{r}
# Print the km.out object
km.out
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
